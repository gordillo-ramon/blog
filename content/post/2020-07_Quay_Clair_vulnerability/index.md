---
title: Vulnerability Scanning with Quay and Clair v4 (with S3 and Noobaa)
date: 2020-08-22
tags: [
    "kubernetes",
    "quay",
    "clair",
    "s3",
    "noobaa",
]
categories: [
    "quay",
    "configuration",
    "samples",
]

---
# Vulnerability Scanning with Quay and Clair v4 (with S3 and Noobaa)

## Setting up Kubernetes (minikube)

I will use the same configuration as [in my previous post](), so I assume I have a minikube up and running and a wildcard domain `*.minikube.cloud` set up.

## Setting up an S3 backend using noobaa

[Noobaa](https://www.noobaa.io/) is a multi-cloud gateway for object storage that allows data federation across cloud providers. In our case, we will use it just for providing a s3 layer on top of kubernetes storage, but it can be used as an abstraction and sync over Azure, AWS and GCP of Ceph at the same time.

```yml
apiVersion: v1
kind: Namespace
metadata:
  name: quay
---
apiVersion: operators.coreos.com/v1
kind: OperatorGroup
metadata:
  name: operatorgroup
  namespace: quay
spec:
  targetNamespaces:
  - quay
---
apiVersion: operators.coreos.com/v1alpha1
kind: Subscription
metadata:
  name: noobaa-quay
  namespace: quay
spec:
  channel: alpha
  name: noobaa-operator
  source: operatorhubio-catalog
  sourceNamespace: olm
```



## Deploying Quay and Clair on Kubernetes

